package hybrid;

import java.io.FileInputStream;
import java.io.IOException;
import java.time.Duration;
import org.apache.poi.xssf.usermodel.XSSFCell;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.firefox.FirefoxDriver;
import sauce_demo.Login_of_sauce;
import sauce_demo.Logout_sauce;
import sauce_demo.Your_product;
import sauce_demo.add_to_cart_sauce;
import sauce_demo.checkout;
public class HYDRID_12 {
	
	public static void main(String[] args) throws IOException {
		WebDriver wd=new FirefoxDriver();
	  //WebDriver wd =new ChromeDriver();
		 wd.get("https://www.saucedemo.com/");
         wd.manage().timeouts().implicitlyWait(Duration.ofSeconds(20)); 
		   FileInputStream f_ile=new FileInputStream("C:\\Users\\balaj\\OneDrive\\Desktop\\sauce_1.xlsx");
		   XSSFWorkbook wk1=new XSSFWorkbook(f_ile);
		   XSSFSheet exsh=wk1.getSheet("KEYS");
		   
		Login_of_sauce lc=new Login_of_sauce(wd);
		add_to_cart_sauce ac=new add_to_cart_sauce(wd);
		Your_product yp=new Your_product(wd);
		checkout co=new checkout(wd);
		Logout_sauce lo=new Logout_sauce(wd);
		for(int i=7;i<=exsh.getLastRowNum();i++)//LOOP OF USERSNME AND PASSOWRD 
        {
           XSSFRow row0=exsh.getRow(i);
           XSSFCell uns=row0.getCell(0);
           XSSFCell pws=row0.getCell(1);
           System.out.println(uns+" "+pws);
           try
           {
        	   for(int j=15;j<=exsh.getLastRowNum();j++)//MAIN KEYS
        		{
        		 XSSFRow row1=exsh.getRow(j);
        		 XSSFCell keydata=row1.getCell(1);
        		 switch(keydata.toString())
    	         {
    	             case "LOGIN":
    		                      
    			                     Thread.sleep(2000);
    		                         lc.username(uns.toString());
    		                         lc.password(pws.toString());
    		                         lc.login();
    		                         Thread.sleep(2000);
    		                      
    			                  break;
    	           case "ADD_TO_CART":
    	                              ac.allElement();
    	                              break;
    	           case "YOUR_PRODUCT":
    		                           yp.AllElements(); 
    		                           break;
    	           case "CHECKOUT":
    		                       XSSFRow chk=exsh.getRow(11);
     		                       XSSFCell firstname=chk.getCell(3);
     		                       XSSFCell lastname=chk.getCell(4);
     		                       XSSFCell pinc=chk.getCell(5);
     		                       co.fname(firstname.toString());
     		                       co.lname(lastname.toString());
     		                       co.pin(pinc.toString());
     		                       Thread.sleep(2000);
                            	   co.rbuttons();
     		                       break;
    	          case "LOGOUT":
     		                    lo.menu();
     		                    lo.logout();
     		                    break;
    	       }
              }
           }
           catch(Exception e)
           {
        	   System.out.println("invaild uername and password");
           }
	}}

}
